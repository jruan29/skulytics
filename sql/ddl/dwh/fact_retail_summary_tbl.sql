CREATE TABLE `{dwh-project}.skulytics_dev.fact_retail_summary_tbl`
(
  retail_summary_key STRING OPTIONS(description=""Primary key of the table [Primary Key]""),
  retailer_product_key STRING OPTIONS(description=""Unique identifier for the retailer-product combination [Business Key]""),
  brand_key INT64 OPTIONS(description=""Unique identifier from dim_brand_tbl [Business Key]""),
  region_key INT64 OPTIONS(description=""unique identifier from dim_region_tbl [Business Key]""),
  retailer_key INT64 OPTIONS(description=""unique identifier from dim_retailer_tbl [Business Key]""),
  product_key STRING OPTIONS(description=""unique identifier from dim_product_tbl [Business Key]""),
  week_end_date DATE OPTIONS(description=""End date of the week (Friday) for the reported metrics""),
  month_start_date DATE OPTIONS(description=""First day of the month for the reported metrics""),
  date_key DATE OPTIONS(description=""unique identifier from dim_date_tbl [Business Key]""),
  last_year_date DATE OPTIONS(description=""Corresponding date in the previous calendar year for YoY comparison""),
  fisc_ly_date DATE OPTIONS(description=""Corresponding date in the previous fiscal year for fiscal YoY comparison""),
  greg_ly_date DATE OPTIONS(description=""Corresponding date in the previous Gregorian calendar year""),
  gross_sales_ty FLOAT64 OPTIONS(description=""indicates gross sales for the product [online sales]""),
  gross_sales_ly FLOAT64 OPTIONS(description=""indicates gross sales for the product [online sales]""),
  gross_sales_fisc_ly FLOAT64 OPTIONS(description=""indicates gross sales for the product in fiscal year[online sales]""),
  gross_sales_greg_ly FLOAT64 OPTIONS(description=""Gross Sales Gregorian Last Year""),
  full_size_units_sold_ty INT64 OPTIONS(description=""Count of full-size product units sold in the current year [online sales]""),
  full_size_units_sold_ly INT64 OPTIONS(description=""Count of full-size product units sold in the previous year [online sales]""),
  full_size_units_sold_fisc_ly INT64 OPTIONS(description=""Count of full-size product units sold in the previous fiscal year [online sales]""),
  full_size_units_sold_greg_ly INT64 OPTIONS(description=""Count of full-size product units sold in the previous Gregorian year [online sales]""),
  oos_within_month_ty INT64 OPTIONS(description=""Number of days the product was out of stock within the current month""),
  oos_within_month_ly INT64 OPTIONS(description=""Number of days the product was out of stock within the previous year's same month""),
  oos_within_month_fisc_ly INT64 OPTIONS(description=""Number of days the product was out of stock in the previous fiscal year's period""),
  oos_within_month_greg_ly INT64 OPTIONS(description=""Number of days the product was out of stock in the previous calendar period""),
  oos_percent_month_ty FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock within the current month""),
  oos_percent_month_ly FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock within the previous year's same month""),
  oos_percent_month_fisc_ly FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock in the previous fiscal year's period""),
  oos_percent_month_greg_ly FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock in the previous Gregorian year's period""),
  oos_within_retail_month_ty INT64 OPTIONS(description=""Number of days the product was out of stock within the current month assigned to start date of retail month""),
  oos_within_retail_month_ly INT64 OPTIONS(description=""Number of days the product was out of stock within the previous year's same month assigned to start date of retail month""),
  oos_within_retail_month_fisc_ly INT64 OPTIONS(description=""Number of days the product was out of stock in the previous fiscal year's period assigned to start date of retail month""),
  oos_within_retail_month_greg_ly INT64 OPTIONS(description=""Number of days the product was out of stock in the previous calendar period assigned to start date of retail month""),
  oos_percent_retail_month_ty FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock within the current month assigned to start date of retail month""),
  oos_percent_retail_month_ly FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock within the previous year's same month assigned to start date of retail month""),
  oos_percent_retail_month_fisc_ly FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock in the previous fiscal year's period assigned to start date of retail month""),
  oos_percent_retail_month_greg_ly FLOAT64 OPTIONS(description=""Percentage of days the product was out of stock in the previous Gregorian year's period assigned to start date of retail month""),
  unit_price_ty FLOAT64 OPTIONS(description=""daily price per unit for the product [stock level]""),
  unit_price_ly FLOAT64 OPTIONS(description=""daily price per unit for the product in the previous year [stock level]""),
  unit_price_fisc_ly FLOAT64 OPTIONS(description=""daily price per unit for the product in the previous fiscal year [Stock Level]""),
  unit_price_greg_ly FLOAT64 OPTIONS(description=""daily price per unit for the product in the previous calendar year [Stock Level]""),
  selling_price_ty FLOAT64 OPTIONS(description=""Final daily selling price per unit after discounts in the current year""),
  selling_price_ly FLOAT64 OPTIONS(description=""Final daily selling price per unit after discounts in the previous year""),
  selling_price_fisc_ly FLOAT64 OPTIONS(description=""Final selling price per unit in the previous fiscal year""),
  selling_price_greg_ly FLOAT64 OPTIONS(description=""Final daily selling price per unit in the previous Calendar year""),
  health_score_ty INT64 OPTIONS(description=""Composite score (0–100) evaluating overall product health and performance [emerch scores]""),
  health_score_ly INT64 OPTIONS(description=""Composite score (0–100) evaluating overall product health and performance in the previous year [emerch scores]""),
  health_score_fisc_ly INT64 OPTIONS(description=""Composite score (0–100) evaluating overall product health and performance in the previous fiscal year [emerch scores]""),
  health_score_greg_ly INT64 OPTIONS(description=""Composite score (0–100) evaluating overall product health and performance in the previous calendar year [emerch scores]""),
  product_title_score_ty INT64 OPTIONS(description=""Score (0–100) assessing effectiveness of the product title for discoverability [emerch scores]""),
  product_title_score_ly INT64 OPTIONS(description=""Score (0–100) assessing effectiveness of the product title for discoverability in the previous year[emerch scores]""),
  product_title_score_fisc_ly INT64 OPTIONS(description=""Score (0–100) assessing effectiveness of the product title for discoverability in the previous fiscal year[emerch scores]""),
  product_title_score_greg_ly INT64 OPTIONS(description=""Score (0–100) assessing effectiveness of the product title for discoverability for previous calendar year[emerch scores]""),
  product_description_score_ty INT64 OPTIONS(description=""Score (0–100) evaluating quality/completeness of the product description[emerch scores]""),
  product_description_score_ly INT64 OPTIONS(description=""Score (0–100) evaluating quality/completeness of the product description for previous year[emerch scores]""),
  product_description_score_fisc_ly INT64 OPTIONS(description=""Score (0–100) evaluating quality/completeness of the product description for previous fiscal year[emerch scores]""),
  product_description_score_greg_ly INT64 OPTIONS(description=""Score (0–100) evaluating quality/completeness of the product description for previous calendar year[emerch scores]""),
  gallery_image_score_ty INT64 OPTIONS(description=""Score (0–100) assessing quality/variety of product images [emerch scores]""),
  gallery_image_score_ly INT64 OPTIONS(description=""Score (0–100) assessing quality/variety of product images in the previous year""),
  gallery_image_score_fisc_ly INT64 OPTIONS(description=""Score (0–100) assessing quality/variety of product images in the previous fiscal year""),
  gallery_image_score_greg_ly INT64 OPTIONS(description=""Score (0–100) assessing quality/variety of product images in the previous calendar year""),
  keyword_analysis_score_ty INT64 OPTIONS(description=""Score (0–100) measuring keyword optimization effectiveness""),
  keyword_analysis_score_ly INT64 OPTIONS(description=""Score (0–100) measuring keyword optimization effectiveness for the previous year""),
  keyword_analysis_score_fisc_ly INT64 OPTIONS(description=""Score (0–100) measuring keyword optimization effectiveness for the previous fiscal year""),
  keyword_analysis_score_greg_ly INT64 OPTIONS(description=""Score (0–100) measuring keyword optimization effectiveness for the previous calendar year""),
  rating_score_ty INT64 OPTIONS(description=""Score (0–100) customer rating score""),
  rating_score_ly INT64 OPTIONS(description=""Score (0–100) customer rating score in the previous year""),
  rating_score_fisc_ly INT64 OPTIONS(description=""Score (0–100) customer rating score in the previous fiscal year""),
  rating_score_greg_ly INT64 OPTIONS(description=""Score (0–100) customer rating score in the previous calendar year""),
  review_score_ty INT64 OPTIONS(description=""Score (0–100) based on review quantity, quality, and sentiment""),
  review_score_ly INT64 OPTIONS(description=""Score (0–100) based on review quantity, quality, and sentiment in the previous year""),
  review_score_fisc_ly INT64 OPTIONS(description=""Score (0–100) based on review quantity, quality, and sentiment in the fiscal previous year""),
  review_score_greg_ly INT64 OPTIONS(description=""Score (0–100) based on review quantity, quality, and sentiment in the previous calendar year""),
  emerch_record_count_ty INT64 OPTIONS(description=""Count of records for a product in e-merchandise source file""),
  emerch_record_count_ly INT64 OPTIONS(description=""Count of records for a product in e-merchandise source file in the previous year""),
  emerch_record_count_fisc_ly INT64 OPTIONS(description=""Count of records for a product in e-merchandise source file in the previous fiscal year""),
  emerch_record_count_greg_ly INT64 OPTIONS(description=""Count of records for a product in e-merchandise source file in the previous calendar year""),
  sponsored_product_spend_ty FLOAT64 OPTIONS(description=""Total spend on sponsored product advertisements""),
  sponsored_product_spend_ly FLOAT64 OPTIONS(description=""Total spend on sponsored product advertisements in the previous year""),
  sponsored_product_spend_fisc_ly FLOAT64 OPTIONS(description=""Total spend on sponsored product advertisements in the previous fiscal year""),
  sponsored_product_spend_greg_ly FLOAT64 OPTIONS(description=""Total spend on sponsored product advertisements in the previous calendar year""),
  sponsored_product_sales_revenue_ty FLOAT64 OPTIONS(description=""Revenue generated from sponsored product placements""),
  sponsored_product_sales_revenue_ly FLOAT64 OPTIONS(description=""Revenue generated from sponsored product placements in the previous year""),
  sponsored_product_sales_revenue_fisc_ly FLOAT64 OPTIONS(description=""Revenue generated from sponsored product placements in the previous fiscal year""),
  sponsored_product_sales_revenue_greg_ly FLOAT64 OPTIONS(description=""Revenue generated from sponsored product placements in the previous calendar year""),
  sponsored_product_number_of_impressions_ty INT64 OPTIONS(description=""Count of ad impressions for sponsored products""),
  sponsored_product_number_of_impressions_ly INT64 OPTIONS(description=""Count of ad impressions for sponsored products in the previous year""),
  sponsored_product_number_of_impressions_fisc_ly INT64 OPTIONS(description=""Count of ad impressions for sponsored products in the previous fiscal year""),
  sponsored_product_number_of_impressions_greg_ly INT64 OPTIONS(description=""Count of ad impressions for sponsored products in the previous calendar year""),
  sponsored_product_number_of_clicks_ty INT64 OPTIONS(description=""Count of clicks on sponsored product ads""),
  sponsored_product_number_of_clicks_ly INT64 OPTIONS(description=""Count of clicks on sponsored product ads in the previous year""),
  sponsored_product_number_of_clicks_fisc_ly INT64 OPTIONS(description=""Count of clicks on sponsored product ads in the previous fiscal year""),
  sponsored_product_number_of_clicks_greg_ly INT64 OPTIONS(description=""Count of clicks on sponsored product ads in the previous calendar year""),
  sponsored_product_units_ty FLOAT64 OPTIONS(description=""Number of units sold through sponsored placements""),
  sponsored_product_units_ly FLOAT64 OPTIONS(description=""Number of units sold through sponsored placements in the previous year""),
  sponsored_product_units_fisc_ly FLOAT64 OPTIONS(description=""Number of units sold through sponsored placements in the previous fiscal year""),
  sponsored_product_units_greg_ly FLOAT64 OPTIONS(description=""Number of units sold through sponsored placements in the previous calendar year""),
  revenue_ty FLOAT64 OPTIONS(description=""Revenue generated from users who visited the product page and completed a purchase""),
  revenue_ly FLOAT64 OPTIONS(description=""Revenue generated from users who visited the product page and completed a purchase in the previous year""),
  revenue_fisc_ly FLOAT64 OPTIONS(description=""Revenue generated from users who visited the product page and completed a purchase in the previous fiscal year""),
  revenue_greg_ly FLOAT64 OPTIONS(description=""Revenue generated from users who visited the product page and completed a purchase in the previous calendar year""),
  units_ty FLOAT64 OPTIONS(description=""Total number of product units sold resulting from product page traffic""),
  units_ly FLOAT64 OPTIONS(description=""Total number of product units sold resulting from product page traffic in the previous year""),
  units_fisc_ly FLOAT64 OPTIONS(description=""Total number of product units sold resulting from product page traffic in the previous fiscal year""),
  units_greg_ly FLOAT64 OPTIONS(description=""Total number of product units sold resulting from product page traffic in the previous calendar year""),
  unit_conversion_ty FLOAT64 OPTIONS(description=""Rate at which product page visits converted into unit sales (units sold per product page visitor)""),
  unit_conversion_ly FLOAT64 OPTIONS(description=""Rate at which product page visits converted into unit sales in the previous year (units sold per product page visitor)""),
  unit_conversion_fisc_ly FLOAT64 OPTIONS(description=""Rate at which product page visits converted into unit sales in the previous fiscal year (units sold per product page visitor)""),
  unit_conversion_greg_ly FLOAT64 OPTIONS(description=""Rate at which product page visits converted into unit sales in the previous calendar year (units sold per product page visitor)""),
  traffic_conversion_rate_ty FLOAT64 OPTIONS(description=""Percentage of product page visitors who completed a purchase (session-level conversion rate)""),
  traffic_conversion_rate_ly FLOAT64 OPTIONS(description=""Percentage of product page visitors who completed a purchase in the previous year(session-level conversion rate)""),
  traffic_conversion_rate_fisc_ly FLOAT64 OPTIONS(description=""Percentage of product page visitors who completed a purchase in the previous fiscal year(session-level conversion rate)""),
  traffic_conversion_rate_greg_ly FLOAT64 OPTIONS(description=""Percentage of product page visitors who completed a purchase in the previous calendar year(session-level conversion rate)""),
  browse_traffic_ty FLOAT64 OPTIONS(description=""Total browse traffic (number of visits) to the product page this year through browsing methods (non-search)""),
  browse_traffic_ly FLOAT64 OPTIONS(description=""Total browse traffic to the product page in the previous year through browsing methods""),
  browse_traffic_fisc_ly FLOAT64 OPTIONS(description=""Total browse traffic to the product page in the previous fiscal year through browsing methods""),
  browse_traffic_greg_ly FLOAT64 OPTIONS(description=""Total browse traffic to the product page in the previous calendar year through browsing methods""),
  pptraffic_ty FLOAT64 OPTIONS(description=""Total product page traffic (number of visits) this year from all sources""),
  pptraffic_ly FLOAT64 OPTIONS(description=""Total product page traffic in the previous year from all sources""),
  pptraffic_fisc_ly FLOAT64 OPTIONS(description=""Total product page traffic in the previous fiscal year from all sources""),
  pptraffic_greg_ly FLOAT64 OPTIONS(description=""Total product page traffic in the previous calendar year from all sources""),
  record_created_date TIMESTAMP OPTIONS(description=""timestamp of when the record was created in GCP""),
  record_updated_date TIMESTAMP OPTIONS(description=""timestamp of when the record was updated in GCP"")
)
PARTITION BY DATE_TRUNC(month_start_date, MONTH)
CLUSTER BY brand_key, retailer_key, product_key
OPTIONS(
  description=""Retail summary fact table""
);